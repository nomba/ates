# Анализ

## Анализ поведения 1

По [требованиям](requirements.md) провожу анализ поведения, используя ES:

![Event Storming](es_diagram_1.svg)

**По бизнес событиям и их связям с друг другом не очень получается декомпозировать вообще на какие либо элементы.** Исходя только из ES, сложно что-то решить.

Смущает требования связанные с ценной за таск [[requirements#Аккаунтинг кто сколько денег заработал]]. C одной стороны:

> цены на задачу определяется единоразово, в момент появления в системе (можно с минимальной задержкой)

С другой 

> формула, которая говорит сколько списать денег с сотрудника при ассайне задачи — `rand(-10..-20)$`

Получается, момент ассайна и есть определение цены. **А что происходит при повторном ассайне?** Если учитывать все требования, то получается на нового сотрудника расспостраняется ранее расчитанная цена. При этом зарплата попуга вообще не привязана к цене таска =):

> формула, которая говорит сколько начислить денег сотруднику для выполненой задачи — `rand(20..40)$`

Спишу это на 

> Смириться с абсурдом топ-менеджмента UberPopug Inc.


## Анализ данных

Из предыдущего этапа осталось много вопросов, составил упрощенную модель данных с прицелом на то, что будет отдельный сервис аналитики:

Диаграмма:
![Data Model](data_diagram.svg)

 Связность между таск-трекером и аккаунтингом достаточно высокая плюс аналитика не имеет процессов и обеспечиваает только запросы по статистике.


## Анализ поведения 2

Передалаю ES основе элементов из предыдущего этапа, на котором видно что аналитика не содержит поведения:

![Event Storming 2](es_diagram_2.svg)


# Модель системы

**Если представить реальную ситуацию: Компании пришла идея по внедрению особенного таск-трекера для улучшения работы сотрудников. Количество работников исчисляется сотнями. То в этом случая, я бы вообще не выделял элементы, глянул в сторону готового решение (YouTrack, Jira) адаптировал его (в YT есть кастомные-Workflow) либо реализовал в монолите, максимум в модульном**. Основным дравером было бы время вакатки (TTM) для проверки гипотезы: "особенный" трекер повысит производительность -  сомнительно)


**Но учитывая то, что система учебная полагаемся на группировку в требованиях, ES и модель данных**, выделяю четыре элемента (сервиса):


![Architecture](architecture.svg)


- Таск-трекер - отвечающий за кор-поддомен, рулит только тасками и их выполнением, без учета цены
- Аккаунтинг - занимается деньгами для попугов
- Аналитика - для админов, чтобы следить за успехами или нет)
- Сервис Authn/Authz - технический сервис для аутентификации и авторизации попугов